#include "Math/RealArray/RealArray.h"
#include "Math/Convolve/IConvolve.h"

class SquarePreprocess
{
private:
    /* data */
    RealArray filterTaps;
    int numOfTaps;
    static const int filterSize = 57;
    //TODO generate this filter on the go
    float taps[filterSize] = {0.000005472130311619,
    -0.000017645573229753,
    -0.000015436191288635,
    0.000063444604392544,
    -0.000001885373990357,
    -0.000099038693388798,
    0.000043201391938751,
    0.000051345101594625,
    -0.000008487244768921,
    0.000082565320040416,
    -0.000261021079542860,
    -0.000148572448421036,
    0.000844722913648813,
    0.000023825685513240,
    -0.004042476603830449,
    0.006301202482890443,
    0.009389212454334878,
    -0.015496204699381079,
    -0.005222973488432799,
    0.009283113676916307,
    0.000469662013011339,
    0.029213655687930440,
    -0.026703976026975690,
    -0.081613512211820061,
    0.103296801514973766,
    0.096793491279932004,
    -0.197419745327182428,
    -0.044523856065037573,
    0.239426229539722230,
    -0.044523856065037226,
    -0.197419745327181068,
    0.096793491279932142,
    0.103296801514973585,
    -0.081613512211819894,
    -0.026703976026975836,
    0.029213655687930613,
    0.000469662013011360,
    0.009283113676916196,
    -0.005222973488432773,
    -0.015496204699381077,
    0.009389212454334855,
    0.006301202482890412,
    -0.004042476603830444,
    0.000023825685513245,
    0.000844722913648786,
    -0.000148572448421031,
    -0.000261021079542854,
    0.000082565320040413,
    -0.000008487244768954,
    0.000051345101594631,
    0.000043201391938758,
    -0.000099038693388802,
    -0.000001885373990367,
    0.000063444604392544,
    -0.000015436191288632,
    -0.000017645573229750,
    0.000005472130311597,};
public:
    SquarePreprocess(float fs, float f0, int numOfTaps);
    int DoPreprocess(IConvolve *pConvolve, RealArray &input, RealArray &output);
    int GetOutputSize(int InputSize);
    ~SquarePreprocess();
};

