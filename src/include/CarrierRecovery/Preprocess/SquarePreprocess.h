#include "Math/ComplexArray/ComplexArray.h"
#include "Math/Convolve/IConvolve.h"

class SquarePreprocess
{
private:
    /* data */
    ComplexArray filterTaps;
    int numOfTaps;
    static const int filterSize = 69;
    //TODO generate this filter on the go
    float taps[filterSize] = {  0.002306997816493991,
  -0.005389988613861647,
  -0.005512949210252055,
  -0.003338271931200729,
  0.0019099998996000938,
  0.007155329788557437,
  0.007844006148472851,
  0.001983143375266723,
  -0.007269327089812973,
  -0.012903098625720208,
  -0.00922516701325589,
  0.002886854803027285,
  0.015253930020336546,
  0.01776394370424141,
  0.0064894585932004775,
  -0.011911341814061201,
  -0.02385466590880789,
  -0.018822675367863504,
  0.001629515039048314,
  0.02344773103673431,
  0.02971685203765512,
  0.01379456636007347,
  -0.01428840310750567,
  -0.034037480617298214,
  -0.029579539580623617,
  -0.0024336164163428473,
  0.02834134874010983,
  0.03966830036232181,
  0.02195347689237775,
  -0.012849800020838369,
  -0.03937346479379847,
  -0.037586806384538,
  -0.008120332654979008,
  0.02770966278082812,
  0.04355652834348129,
  0.02770966278082812,
  -0.008120332654979008,
  -0.037586806384538,
  -0.03937346479379847,
  -0.012849800020838369,
  0.02195347689237775,
  0.03966830036232181,
  0.02834134874010983,
  -0.0024336164163428473,
  -0.029579539580623617,
  -0.034037480617298214,
  -0.01428840310750567,
  0.01379456636007347,
  0.02971685203765512,
  0.02344773103673431,
  0.001629515039048314,
  -0.018822675367863504,
  -0.02385466590880789,
  -0.011911341814061201,
  0.0064894585932004775,
  0.01776394370424141,
  0.015253930020336546,
  0.002886854803027285,
  -0.00922516701325589,
  -0.012903098625720208,
  -0.007269327089812973,
  0.001983143375266723,
  0.007844006148472851,
  0.007155329788557437,
  0.0019099998996000938,
  -0.003338271931200729,
  -0.005512949210252055,
  -0.005389988613861647,
  0.002306997816493991};
public:
    SquarePreprocess(float fs, float f0, int numOfTaps);
    int DoPreprocess(IConvolve *pConvolve, ComplexArray &input, ComplexArray &output);
    int GetOutputSize(int InputSize);
    ~SquarePreprocess();
};

